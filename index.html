<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live HTML and CSS Editor</title>
    <link rel="stylesheet" href="./style.css">
    
</head>

<body>
    <div id="challenge">
        <h2>Recreate Below Shape</h2>
        <img src="eclipse.png" alt="Shape Image" style="max-width: 100%;">
    </div>

    <div id="editor">
        <div id="lineNumbers"></div>
        <textarea id="codeInput" placeholder="Write your HTML and CSS code here..." oninput="updateOutput()" onscroll="syncScroll()"></textarea>
    </div>

    <div id="output">
        <button id="clear">Clear</button>
        <iframe id="outputFrame" frameborder="0"></iframe>
    </div>

    <script>
   function updateOutput() {
    const editorContent = document.getElementById('codeInput').value;
    const outputFrame = document.getElementById('outputFrame');
    const output = outputFrame.contentDocument || outputFrame.contentWindow.document;

    output.open();
    output.write(editorContent);
    output.close();

    // Update line numbers based on visible lines
    updateVisibleLineNumbers();
}

function updateVisibleLineNumbers() {
    var codeInput = document.getElementById("codeInput");
    var lineNumbers = document.getElementById("lineNumbers");

    var scrollTop = codeInput.scrollTop;
    var lineHeight = codeInput.scrollHeight / codeInput.rows;
    var firstVisibleLineNumber = Math.floor(scrollTop / lineHeight) + 1;

    var lines = codeInput.value.split("\n");
    var lineNumberContent = "";

    for (var i = firstVisibleLineNumber; i <= lines.length; i++) {
        lineNumberContent += i + "<br>";
    }

    lineNumbers.innerHTML = "<pre>" + lineNumberContent + "</pre>";
}

function syncScroll() {
    var codeInput = document.getElementById("codeInput");
    var lineNumbers = document.getElementById("lineNumbers");

    lineNumbers.scrollTop = codeInput.scrollTop;
}

// Initial line numbers update
updateVisibleLineNumbers();


let clear = document.getElementById('clear');
clear.addEventListener('click', function(){
document.getElementById('editor').querySelector('textarea').value = '';
updateOutput();
// why updateOutput is called here? 

})
    </script>
</body>

</html>